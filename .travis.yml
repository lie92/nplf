language: go

go:
  - "1.11"

os: 
  - windows

sudo: false

branches:
  only:
    - master

install:
  # Setting environments variables
  - export PATH=$PATH:$HOME/gopath/bin
  - 'if [[ "$TRAVIS_BRANCH" == "master" ]]; then export REVEL_BRANCH="master"; fi'
  - 'echo "Travis branch: $TRAVIS_BRANCH, Revel dependency branch: $REVEL_BRANCH"'
  - git clone -b $REVEL_BRANCH git://github.com/revel/modules ../modules/
  - git clone -b $REVEL_BRANCH git://github.com/revel/revel ../revel/
  - git clone -b $REVEL_BRANCH git://github.com/revel/cmd ../cmd/
  - git clone -b $REVEL_BRANCH git://github.com/revel/config ../config/
  - git clone -b $REVEL_BRANCH git://github.com/revel/cron ../cron/
  - go get -t -v github.com/revel/revel/...
  - go get -t -v github.com/revel/cmd/revel

script:
  # Commented out persona test sample, since persona.org gonna be shutdown.
  # Also http://personatestuser.org becomes non-responsive most of the time.
  # https://wiki.mozilla.org/Identity/Persona_Shutdown_Guidelines_for_Reliers
  # - revel test github.com/revel/examples/persona
  # Build & run the sample apps
  - revel test -v -a github.com/lie92/nplf
